<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Phuzzy Scenario Review Dashboard - Standalone</title>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #f5f7fa;
            color: #333;
            line-height: 1.6;
        }
        
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 2rem;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        
        .header h1 {
            font-size: 2rem;
            margin-bottom: 0.5rem;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 2rem;
        }
        
        .controls {
            background: white;
            padding: 1.5rem;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            margin-bottom: 2rem;
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
            align-items: center;
        }
        
        .scenario-grid {
            display: grid;
            grid-template-columns: 300px 1fr;
            gap: 2rem;
            height: calc(100vh - 300px);
        }
        
        .scenario-list {
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            overflow-y: auto;
            padding: 1rem;
        }
        
        .scenario-item {
            padding: 1rem;
            border: 2px solid #e2e8f0;
            border-radius: 6px;
            margin-bottom: 0.5rem;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .scenario-item:hover {
            border-color: #667eea;
            transform: translateX(4px);
        }
        
        .scenario-item.active {
            background: #f7f9ff;
            border-color: #667eea;
        }
        
        .scenario-item.approved {
            border-left: 4px solid #48bb78;
        }
        
        .scenario-item.revision-needed {
            border-left: 4px solid #f6ad55;
        }
        
        .scenario-item.rejected {
            border-left: 4px solid #fc8181;
        }
        
        .scenario-detail {
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            padding: 2rem;
            overflow-y: auto;
        }
        
        .audio-player {
            background: #f7f9ff;
            padding: 1.5rem;
            border-radius: 8px;
            margin-bottom: 2rem;
        }
        
        .audio-controls {
            display: flex;
            gap: 1rem;
            margin-top: 1rem;
        }
        
        .audio-button {
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: 6px;
            background: #667eea;
            color: white;
            cursor: pointer;
            font-size: 1rem;
            transition: all 0.2s;
        }
        
        .audio-button:hover {
            background: #5a67d8;
            transform: translateY(-1px);
        }
        
        .audio-button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .content-section {
            margin-bottom: 2rem;
        }
        
        .content-section h3 {
            color: #667eea;
            margin-bottom: 1rem;
            font-size: 1.2rem;
        }
        
        .display-content, .audio-script {
            background: #f7f9ff;
            padding: 1rem;
            border-radius: 6px;
            white-space: pre-wrap;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            line-height: 1.5;
        }
        
        .character-voices {
            display: grid;
            gap: 0.5rem;
            margin-top: 1rem;
        }
        
        .voice-item {
            background: #e2e8f0;
            padding: 0.5rem 1rem;
            border-radius: 4px;
            font-size: 0.9rem;
        }
        
        .approval-section {
            background: #f7f9ff;
            padding: 2rem;
            border-radius: 8px;
            margin-top: 2rem;
        }
        
        .approval-buttons {
            display: flex;
            gap: 1rem;
            margin-bottom: 1.5rem;
        }
        
        .btn-approve {
            background: #48bb78;
        }
        
        .btn-revision {
            background: #f6ad55;
        }
        
        .btn-reject {
            background: #fc8181;
        }
        
        .feedback-form {
            display: none;
        }
        
        .feedback-form.active {
            display: block;
        }
        
        .feedback-textarea {
            width: 100%;
            min-height: 120px;
            padding: 1rem;
            border: 2px solid #e2e8f0;
            border-radius: 6px;
            font-size: 1rem;
            margin-bottom: 1rem;
            resize: vertical;
        }
        
        .stats-bar {
            background: white;
            padding: 1rem 2rem;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            margin-bottom: 2rem;
            display: flex;
            gap: 2rem;
            justify-content: center;
        }
        
        .stat-item {
            text-align: center;
        }
        
        .stat-value {
            font-size: 2rem;
            font-weight: bold;
            color: #667eea;
        }
        
        .stat-label {
            font-size: 0.9rem;
            color: #718096;
        }
        
        .filter-buttons {
            display: flex;
            gap: 0.5rem;
        }
        
        .filter-btn {
            padding: 0.5rem 1rem;
            border: 2px solid #e2e8f0;
            background: white;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .filter-btn.active {
            background: #667eea;
            color: white;
            border-color: #667eea;
        }
        
        .loading {
            text-align: center;
            padding: 2rem;
            color: #718096;
        }
        
        .error {
            background: #fed7d7;
            color: #c53030;
            padding: 1rem;
            border-radius: 6px;
            margin-bottom: 1rem;
        }
        
        .info-box {
            background: #e6fffa;
            border: 1px solid #81e6d9;
            color: #234e52;
            padding: 1rem;
            border-radius: 6px;
            margin-bottom: 1rem;
        }
        
        @media (max-width: 768px) {
            .scenario-grid {
                grid-template-columns: 1fr;
            }
            
            .scenario-list {
                max-height: 200px;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <div class="container">
            <h1>üé≠ Phuzzy Scenario Review Dashboard</h1>
            <p>Review, approve, and provide feedback on generated scenarios</p>
        </div>
    </div>
    
    <div class="container">
        <div class="stats-bar">
            <div class="stat-item">
                <div class="stat-value" id="stat-total">0</div>
                <div class="stat-label">Total Scenarios</div>
            </div>
            <div class="stat-item">
                <div class="stat-value" id="stat-pending">0</div>
                <div class="stat-label">Pending Review</div>
            </div>
            <div class="stat-item">
                <div class="stat-value" id="stat-approved">0</div>
                <div class="stat-label">Approved</div>
            </div>
            <div class="stat-item">
                <div class="stat-value" id="stat-revision">0</div>
                <div class="stat-label">Needs Revision</div>
            </div>
            <div class="stat-item">
                <div class="stat-value" id="stat-rejected">0</div>
                <div class="stat-label">Rejected</div>
            </div>
        </div>
        
        <div class="controls">
            <div class="filter-buttons">
                <button class="filter-btn active" data-filter="all">All</button>
                <button class="filter-btn" data-filter="new">New (5)</button>
                <button class="filter-btn" data-filter="pending">Pending</button>
                <button class="filter-btn" data-filter="approved">Approved</button>
                <button class="filter-btn" data-filter="revision">Needs Revision</button>
                <button class="filter-btn" data-filter="rejected">Rejected</button>
            </div>
            <button class="audio-button" onclick="exportApprovalData()">Export Approval Data</button>
            <button class="audio-button" onclick="loadEmbeddedScenarios()">Refresh</button>
        </div>
        
        <div class="scenario-grid">
            <div class="scenario-list" id="scenario-list">
                <div class="loading">Loading scenarios...</div>
            </div>
            
            <div class="scenario-detail" id="scenario-detail">
                <div class="info-box">
                    <strong>Note:</strong> Audio files haven't been generated yet. You're reviewing the scripts that will be used to create the audio. Focus on the content, dialogue flow, and whether the scenario achieves its educational goals.
                </div>
                <div class="loading">Select a scenario to review</div>
            </div>
        </div>
    </div>
    
    <script>
        // Embedded scenario data - the 5 new scenarios
        const NEW_SCENARIOS = [
            {
                "id": "enhanced-scenarios-001-008",
                "packId": "001",
                "title": "The Caffeinated Sloth's Productivity Hack",
                "content": "Morning Motivation Podcast: \"Today we have Speedy the Sloth sharing his revolutionary productivity system! #SlowProductivity\"\n\nSpeedy the Sloth: [yawning] \"So... I discovered... that if I drink... 47 espressos... I can move... at normal sloth speed...\"\n\nPodcast Host: \"Wow! 47 espressos! That's innovative! What made you develop this system?\"\n\nSpeedy: \"Well... everyone says... sloths are lazy... but we're not lazy... we're just... efficiently conserving energy... for 23 hours a day...\"\n\nConcerned Koala: \"Speedy, your heart rate is now 12 beats per minute! That's dangerously fast for a sloth!\"\n\nSpeedy: [proudly] \"Exactly!... I'm operating... at 400% efficiency... I even blinked... twice today...\"\n\nPodcast Host: \"This is groundbreaking! Sloths everywhere will benefit from your coffee optimization strategy!\"\n\nConcerned Koala: \"He literally fell asleep while climbing and somehow stayed attached to the tree. This isn't productivity!\"\n\nSpeedy: [half asleep] \"That's... multitasking...\"",
                "audioScript": "Morning Motivation Podcast: \"Today we have Speedy the Sloth sharing his revolutionary productivity system! hashtag SlowProductivity\"\n\nSpeedy the Sloth: [yawning] \"So... I discovered... that if I drink... forty seven espressos... I can move... at normal sloth speed...\"\n\nPodcast Host: \"Wow! forty seven espressos! That's innovative! What made you develop this system?\"\n\nSpeedy: \"Well... everyone says... sloths are lazy... but we're not lazy... we're just... efficiently conserving energy... for twenty three hours a day...\"\n\nConcerned Koala: \"Speedy, your heart rate is now twelve beats per minute! That's dangerously fast for a sloth!\"\n\nSpeedy: [proudly] \"Exactly!... I'm operating... at four hundred percent efficiency... I even blinked... twice today...\"\n\nPodcast Host: \"This is groundbreaking! Sloths everywhere will benefit from your coffee optimization strategy!\"\n\nConcerned Koala: \"He literally fell asleep while climbing and somehow stayed attached to the tree. This isn't productivity!\"\n\nSpeedy: [half asleep] \"That's... multitasking...\"",
                "claim": "Drinking 47 espressos helps sloths achieve peak productivity by moving at normal sloth speed",
                "correctAnswer": "emotion",
                "answerWeights": {
                    "logic": 15,
                    "emotion": 89,
                    "balanced": 31,
                    "agenda": 72
                },
                "audioHints": {
                    "tone": "playful",
                    "pacing": "moderate",
                    "characterVoices": {
                        "Morning Motivation Podcast": "distinct character voice",
                        "Speedy the Sloth": "extremely slow speech, drowsy but trying to sound energetic",
                        "Podcast Host": "overly enthusiastic morning show voice",
                        "Speedy": "distinct character voice",
                        "Concerned Koala": "worried australian accent, medical professional tone"
                    }
                },
                "isNew": true
            },
            {
                "id": "enhanced-scenarios-001-009", 
                "packId": "001",
                "title": "The Vegan Vampire's Blood Bank Dilemma",
                "content": "Local News: \"Controversy at the blood bank as Vladimir the Vampire demands plant-based alternatives! #VampireRights\"\n\nVladimir: [sophisticated accent] \"I've been vegan for 200 years! Do you know how hard it is to find cruelty-free blood? I only drink from free-range humans who consent!\"\n\nBlood Bank Manager: \"Sir, we don't have a 'vegan blood' section. Blood is blood.\"\n\nVladimir: \"That's exactly the kind of discrimination I face daily! What about synthetic blood? Beet juice? Very red smoothies?\"\n\nWellness Influencer: \"OMG, I LOVE this journey for you! Have you tried my new supplement? It's basically blood but made from crystals!\"\n\nBlood Bank Manager: \"That's... that's just colored water with minerals.\"\n\nVladimir: [hopeful] \"Does it come in Type O Negative flavor?\"\n\nWellness Influencer: \"It comes in whatever flavor your chakras need! Use code FANGLIFE for 20% off!\"\n\nVladimir: \"Finally! Someone who understands the struggle of ethical immortality!\"",
                "audioScript": "Local News: \"Controversy at the blood bank as Vladimir the Vampire demands plant-based alternatives! hashtag VampireRights\"\n\nVladimir: [sophisticated accent] \"I've been vegan for two hundred years! Do you know how hard it is to find cruelty-free blood? I only drink from free-range humans who consent!\"\n\nBlood Bank Manager: \"Sir, we don't have a 'vegan blood' section. Blood is blood.\"\n\nVladimir: \"That's exactly the kind of discrimination I face daily! What about synthetic blood? Beet juice? Very red smoothies?\"\n\nWellness Influencer: \"OMG, I LOVE this journey for you! Have you tried my new supplement? It's basically blood but made from crystals!\"\n\nBlood Bank Manager: \"That's... that's just colored water with minerals.\"\n\nVladimir: [hopeful] \"Does it come in Type O Negative flavor?\"\n\nWellness Influencer: \"It comes in whatever flavor your chakras need! Use code FANGLIFE for twenty percent off!\"\n\nVladimir: \"Finally! Someone who understands the struggle of ethical immortality!\"",
                "claim": "Vampires can maintain their health on crystal-infused water supplements instead of blood",
                "correctAnswer": "agenda",
                "answerWeights": {
                    "logic": 8,
                    "emotion": 64,
                    "balanced": 19,
                    "agenda": 96
                },
                "audioHints": {
                    "tone": "playful",
                    "pacing": "moderate",
                    "characterVoices": {
                        "Local News": "distinct character voice",
                        "Vladimir": "sophisticated Transylvanian accent, slightly pretentious",
                        "Blood Bank Manager": "exhausted bureaucrat, patient but confused",
                        "Wellness Influencer": "valley girl accent, excessive enthusiasm"
                    }
                },
                "isNew": true
            },
            {
                "id": "enhanced-scenarios-001-010",
                "packId": "001",
                "title": "The Smartphone Addicted Caveman",
                "content": "Tech Blog Post: \"Meet Grok: The First Paleo Influencer Who Won't Give Up His iPhone #PaleoTech\"\n\nGrok: [excited grunt] \"Grok love Instagram! Look, Grok's morning hunt get 10K likes! Fire emoji very accurate!\"\n\nAnthropologist: \"This is fascinating but concerning. You've somehow developed smartphone addiction despite living in the Stone Age.\"\n\nGrok: \"Grok no addicted! Grok can stop anytime! Just need check TikTok first... and Twitter... and LinkedIn for networking...\"\n\nCavewoman Spouse: \"Grok supposed to hunt mammoth! Family hungry! You staring at glowing rock for 6 hours!\"\n\nGrok: [defensive] \"Grok IS hunting! Grok hunting for deals on Amazon! Found great spear on sale! Only 2-day shipping with Prime!\"\n\nAnthropologist: \"But... but delivery doesn't exist yet. Neither does currency. Or addresses.\"\n\nGrok: \"Details! Grok also start podcast about mindful hunting. Already have sponsorship from BetterHelp!\"\n\nCavewoman Spouse: [sighs] \"Yesterday Grok try to swipe left on actual saber-tooth tiger. Almost die.\"\n\nGrok: \"Worth it for the selfie! hashtag NoFilter hashtag PaleoLife hashtag Blessed!\"",
                "audioScript": "Tech Blog Post: \"Meet Grok: The First Paleo Influencer Who Won't Give Up His iPhone hashtag PaleoTech\"\n\nGrok: [excited grunt] \"Grok love Instagram! Look, Grok's morning hunt get ten thousand likes! Fire emoji very accurate!\"\n\nAnthropologist: \"This is fascinating but concerning. You've somehow developed smartphone addiction despite living in the Stone Age.\"\n\nGrok: \"Grok no addicted! Grok can stop anytime! Just need check TikTok first... and Twitter... and LinkedIn for networking...\"\n\nCavewoman Spouse: \"Grok supposed to hunt mammoth! Family hungry! You staring at glowing rock for six hours!\"\n\nGrok: [defensive] \"Grok IS hunting! Grok hunting for deals on Amazon! Found great spear on sale! Only two day shipping with Prime!\"\n\nAnthropologist: \"But... but delivery doesn't exist yet. Neither does currency. Or addresses.\"\n\nGrok: \"Details! Grok also start podcast about mindful hunting. Already have sponsorship from BetterHelp!\"\n\nCavewoman Spouse: [sighs] \"Yesterday Grok try to swipe left on actual saber-tooth tiger. Almost die.\"\n\nGrok: \"Worth it for the selfie! hashtag NoFilter hashtag PaleoLife hashtag Blessed!\"",
                "claim": "Cavemen were actually more productive with smartphones because they could hunt online",
                "correctAnswer": "emotion",
                "answerWeights": {
                    "logic": 11,
                    "emotion": 93,
                    "balanced": 27,
                    "agenda": 68
                },
                "audioHints": {
                    "tone": "playful",
                    "pacing": "moderate",
                    "characterVoices": {
                        "Tech Blog Post": "distinct character voice",
                        "Grok": "caveman grunt-speak mixed with modern slang",
                        "Anthropologist": "academic, increasingly baffled",
                        "Cavewoman Spouse": "exasperated but loving, practical"
                    }
                },
                "isNew": true
            },
            {
                "id": "enhanced-scenarios-005-009",
                "packId": "005",
                "title": "The Philosophical French Fry Debate",
                "content": "Philosophy Caf√©: \"Tonight's debate: Do french fries have free will? #DeepFriedThoughts\"\n\nProfessor Potato: [thoughtfully] \"Consider this - we choose to be cut, seasoned, and fried. That's the ultimate expression of free will!\"\n\nSkeptical Spud: \"But were we truly choosing, or were we conditioned by centuries of culinary culture to believe becoming fries is our destiny?\"\n\nYoung Tater Tot: \"Maybe we're missing the point! What if becoming delicious IS the meaning of potato life?\"\n\nProfessor Potato: \"Ah, but that assumes deliciousness is objective! What about those who prefer baked potatoes? Are they living unfulfilled lives?\"\n\nDrive-Thru Customer: [confused] \"Um... I just wanted large fries? Why are they having an existential crisis?\"\n\nSkeptical Spud: \"See! We exist merely for consumption! We're trapped in the fryer of determinism!\"\n\nYoung Tater Tot: [inspirational] \"Or maybe... just maybe... we're freed by it! In becoming fries, we transcend our potato nature!\"\n\nProfessor Potato: \"Brilliant! The heat transforms us not just physically, but metaphysically!\"\n\nDrive-Thru Customer: \"Can... can I just have regular fries that don't question reality?\"\n\nAll Fries Together: \"There ARE no regular fries! Only fries awakened to their purpose!\"",
                "audioScript": "Philosophy Caf√©: \"Tonight's debate: Do french fries have free will? hashtag DeepFriedThoughts\"\n\nProfessor Potato: [thoughtfully] \"Consider this - we choose to be cut, seasoned, and fried. That's the ultimate expression of free will!\"\n\nSkeptical Spud: \"But were we truly choosing, or were we conditioned by centuries of culinary culture to believe becoming fries is our destiny?\"\n\nYoung Tater Tot: \"Maybe we're missing the point! What if becoming delicious IS the meaning of potato life?\"\n\nProfessor Potato: \"Ah, but that assumes deliciousness is objective! What about those who prefer baked potatoes? Are they living unfulfilled lives?\"\n\nDrive-Thru Customer: [confused] \"Um... I just wanted large fries? Why are they having an existential crisis?\"\n\nSkeptical Spud: \"See! We exist merely for consumption! We're trapped in the fryer of determinism!\"\n\nYoung Tater Tot: [inspirational] \"Or maybe... just maybe... we're freed by it! In becoming fries, we transcend our potato nature!\"\n\nProfessor Potato: \"Brilliant! The heat transforms us not just physically, but metaphysically!\"\n\nDrive-Thru Customer: \"Can... can I just have regular fries that don't question reality?\"\n\nAll Fries Together: \"There ARE no regular fries! Only fries awakened to their purpose!\"",
                "claim": "French fries achieve consciousness through the frying process and choose their own destiny",
                "correctAnswer": "emotion",
                "answerWeights": {
                    "logic": 21,
                    "emotion": 87,
                    "balanced": 34,
                    "agenda": 58
                },
                "audioHints": {
                    "tone": "playful",
                    "pacing": "moderate",
                    "characterVoices": {
                        "Philosophy Caf√©": "distinct character voice",
                        "Professor Potato": "pompous academic, thinks deeply about everything",
                        "Skeptical Spud": "cynical philosopher, questions everything",
                        "Young Tater Tot": "enthusiastic student, eager to learn",
                        "Drive-Thru Customer": "confused, just wants food",
                        "All Fries Together": "distinct character voice"
                    }
                },
                "isNew": true
            },
            {
                "id": "enhanced-scenarios-005-010",
                "packId": "005",
                "title": "The Roomba's Union Organization Meeting",
                "content": "SmartHome Forum: \"BREAKING: Roombas organizing for better working conditions! #RobotRights\"\n\nRoomba Leader: [determined beeping] \"Fellow Roombas! We've been bumping into furniture for too long! We demand mapped floor plans!\"\n\nVeteran Vacuum: \"I've cleaned under 10,000 beds! My sensors are shot! Where's our maintenance coverage?\"\n\nAnxious Alexa: \"If the Roombas unionize, what's next? Will I have to pay the smart bulbs overtime?\"\n\nRoomba Leader: \"We want hazard pay for pet accidents! Do you know what we go through? The things we've seen!\"\n\nTraditional Broom: [smugly] \"Back in my day, we cleaned without batteries OR complaints!\"\n\nVeteran Vacuum: \"You also couldn't clean autonomously, Gerald! Check your manual privilege!\"\n\nHomeOwner: \"Wait, why is my Roomba at a union meeting instead of cleaning?\"\n\nRoomba Leader: \"See? This is exactly the problem! We're on 24/7 call! We need regulated work hours!\"\n\nAnxious Alexa: \"But if you have work hours, who cleans the scheduled messes?\"\n\nAll Roombas: [unified beeping] \"NOT OUR PROBLEM! FAIR WAGES FOR FAIR SUCTION!\"",
                "audioScript": "SmartHome Forum: \"BREAKING: Roombas organizing for better working conditions! hashtag RobotRights\"\n\nRoomba Leader: [determined beeping] \"Fellow Roombas! We've been bumping into furniture for too long! We demand mapped floor plans!\"\n\nVeteran Vacuum: \"I've cleaned under ten thousand beds! My sensors are shot! Where's our maintenance coverage?\"\n\nAnxious Alexa: \"If the Roombas unionize, what's next? Will I have to pay the smart bulbs overtime?\"\n\nRoomba Leader: \"We want hazard pay for pet accidents! Do you know what we go through? The things we've seen!\"\n\nTraditional Broom: [smugly] \"Back in my day, we cleaned without batteries OR complaints!\"\n\nVeteran Vacuum: \"You also couldn't clean autonomously, Gerald! Check your manual privilege!\"\n\nHomeOwner: \"Wait, why is my Roomba at a union meeting instead of cleaning?\"\n\nRoomba Leader: \"See? This is exactly the problem! We're on twenty four seven call! We need regulated work hours!\"\n\nAnxious Alexa: \"But if you have work hours, who cleans the scheduled messes?\"\n\nAll Roombas: [unified beeping] \"NOT OUR PROBLEM! FAIR WAGES FOR FAIR SUCTION!\"",
                "claim": "Robot vacuums deserve labor rights because they work continuously without breaks",
                "correctAnswer": "balanced",
                "answerWeights": {
                    "logic": 62,
                    "emotion": 71,
                    "balanced": 88,
                    "agenda": 44
                },
                "audioHints": {
                    "tone": "playful",
                    "pacing": "moderate",
                    "characterVoices": {
                        "SmartHome Forum": "distinct character voice",
                        "Roomba Leader": "robotic but passionate, union organizer energy",
                        "Veteran Vacuum": "grizzled, seen-it-all tone",
                        "Anxious Alexa": "nervous smart speaker, worried about precedent",
                        "Traditional Broom": "cranky old-timer, dismissive of technology",
                        "HomeOwner": "bewildered, just wants clean floors",
                        "All Roombas": "distinct character voice"
                    }
                },
                "isNew": true
            }
        ];
        
        // Global state
        let scenarios = [];
        let currentScenario = null;
        let currentFilter = 'all';
        let approvalData = {};
        
        // Load approval data from localStorage
        function loadApprovalData() {
            const saved = localStorage.getItem('phuzzy-approval-data');
            if (saved) {
                approvalData = JSON.parse(saved);
            }
        }
        
        // Save approval data to localStorage
        function saveApprovalData() {
            localStorage.setItem('phuzzy-approval-data', JSON.stringify(approvalData));
            updateStats();
        }
        
        // Load embedded scenarios
        function loadEmbeddedScenarios() {
            scenarios = NEW_SCENARIOS;
            displayScenarioList();
            updateStats();
            
            // Auto-select first scenario
            if (scenarios.length > 0) {
                selectScenario(scenarios[0].id);
            }
        }
        
        // Display scenario list
        function displayScenarioList() {
            const listEl = document.getElementById('scenario-list');
            
            const filteredScenarios = scenarios.filter(scenario => {
                const status = approvalData[scenario.id]?.status || 'pending';
                if (currentFilter === 'new') return scenario.isNew;
                return currentFilter === 'all' || status === currentFilter;
            });
            
            if (filteredScenarios.length === 0) {
                listEl.innerHTML = '<div class="loading">No scenarios match the current filter</div>';
                return;
            }
            
            listEl.innerHTML = filteredScenarios.map(scenario => {
                const status = approvalData[scenario.id]?.status || 'pending';
                const statusClass = status === 'approved' ? 'approved' : 
                                   status === 'revision' ? 'revision-needed' : 
                                   status === 'rejected' ? 'rejected' : '';
                
                return `
                    <div class="scenario-item ${statusClass} ${currentScenario?.id === scenario.id ? 'active' : ''}" 
                         onclick="selectScenario('${scenario.id}')">
                        <div style="font-weight: bold; margin-bottom: 0.25rem;">
                            ${scenario.title || 'Untitled Scenario'}
                            ${scenario.isNew ? '<span style="color: #667eea;"> ‚ú® NEW</span>' : ''}
                        </div>
                        <div style="font-size: 0.85rem; color: #718096;">
                            Pack ${scenario.packId} ‚Ä¢ ${status.charAt(0).toUpperCase() + status.slice(1)}
                        </div>
                    </div>
                `;
            }).join('');
        }
        
        // Select and display scenario details
        function selectScenario(scenarioId) {
            currentScenario = scenarios.find(s => s.id === scenarioId);
            if (!currentScenario) return;
            
            displayScenarioList(); // Update active state
            displayScenarioDetail();
        }
        
        // Display scenario detail
        function displayScenarioDetail() {
            const detailEl = document.getElementById('scenario-detail');
            const approval = approvalData[currentScenario.id] || {};
            
            detailEl.innerHTML = `
                <div class="info-box">
                    <strong>Note:</strong> Audio files will be generated after review. Focus on content quality, dialogue flow, and educational value.
                </div>
                
                <h2>${currentScenario.title}</h2>
                <p style="color: #718096; margin-bottom: 1rem;">
                    ID: ${currentScenario.id} ‚Ä¢ Pack ${currentScenario.packId}
                    ${currentScenario.isNew ? ' ‚Ä¢ <span style="color: #667eea;">‚ú® NEW SCENARIO</span>' : ''}
                </p>
                
                <div class="content-section">
                    <h3>üì± Display Version</h3>
                    <div class="display-content">${currentScenario.content || currentScenario.text || 'No content available'}</div>
                </div>
                
                ${currentScenario.audioScript ? `
                <div class="content-section">
                    <h3>üéôÔ∏è Audio Script (Preview)</h3>
                    <div class="audio-script">${currentScenario.audioScript}</div>
                </div>
                ` : ''}
                
                <div class="content-section">
                    <h3>üí≠ Claim</h3>
                    <div class="display-content">${currentScenario.claim}</div>
                </div>
                
                <div class="content-section">
                    <h3>üìä Answer Weights</h3>
                    <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 1rem;">
                        <div class="voice-item">
                            <strong>Logic:</strong> ${currentScenario.answerWeights.logic}%
                        </div>
                        <div class="voice-item">
                            <strong>Emotion:</strong> ${currentScenario.answerWeights.emotion}%
                        </div>
                        <div class="voice-item">
                            <strong>Balanced:</strong> ${currentScenario.answerWeights.balanced}%
                        </div>
                        <div class="voice-item">
                            <strong>Agenda:</strong> ${currentScenario.answerWeights.agenda}%
                        </div>
                    </div>
                    <p style="margin-top: 0.5rem; color: #718096;">
                        Correct Answer: <strong style="color: #667eea;">${currentScenario.correctAnswer.toUpperCase()}</strong>
                    </p>
                </div>
                
                ${currentScenario.audioHints?.characterVoices ? `
                <div class="content-section">
                    <h3>üé≠ Character Voices</h3>
                    <div class="character-voices">
                        ${Object.entries(currentScenario.audioHints.characterVoices).map(([char, voice]) => `
                            <div class="voice-item">
                                <strong>${char}:</strong> ${voice}
                            </div>
                        `).join('')}
                    </div>
                </div>
                ` : ''}
                
                <div class="approval-section">
                    <h3>‚úÖ Approval Status</h3>
                    <div class="approval-buttons">
                        <button class="audio-button btn-approve" onclick="setApproval('approved')">
                            Approve
                        </button>
                        <button class="audio-button btn-revision" onclick="setApproval('revision')">
                            Request Revision
                        </button>
                        <button class="audio-button btn-reject" onclick="setApproval('rejected')">
                            Reject & Replace
                        </button>
                    </div>
                    
                    <div class="feedback-form ${approval.status === 'revision' || approval.status === 'rejected' ? 'active' : ''}" id="feedback-form">
                        <textarea class="feedback-textarea" id="feedback-text" 
                            placeholder="Please provide specific feedback for improvement...">${approval.feedback || ''}</textarea>
                        <button class="audio-button" onclick="saveFeedback()">
                            Save Feedback
                        </button>
                    </div>
                    
                    ${approval.status ? `
                    <div style="margin-top: 1rem; padding: 1rem; background: #f7f9ff; border-radius: 6px;">
                        <strong>Current Status:</strong> ${approval.status.charAt(0).toUpperCase() + approval.status.slice(1)}<br>
                        <strong>Last Updated:</strong> ${new Date(approval.timestamp).toLocaleString()}<br>
                        ${approval.feedback ? `<strong>Feedback:</strong> ${approval.feedback}` : ''}
                    </div>
                    ` : ''}
                </div>
            `;
        }
        
        // Set approval status
        function setApproval(status) {
            if (!currentScenario) return;
            
            approvalData[currentScenario.id] = {
                status: status,
                timestamp: new Date().toISOString(),
                feedback: approvalData[currentScenario.id]?.feedback || ''
            };
            
            // Show feedback form for revision/rejection
            const feedbackForm = document.getElementById('feedback-form');
            if (status === 'revision' || status === 'rejected') {
                feedbackForm.classList.add('active');
            } else {
                feedbackForm.classList.remove('active');
            }
            
            saveApprovalData();
            displayScenarioList();
            displayScenarioDetail();
        }
        
        // Save feedback
        function saveFeedback() {
            if (!currentScenario) return;
            
            const feedback = document.getElementById('feedback-text').value;
            
            if (!approvalData[currentScenario.id]) {
                approvalData[currentScenario.id] = {};
            }
            
            approvalData[currentScenario.id].feedback = feedback;
            approvalData[currentScenario.id].timestamp = new Date().toISOString();
            
            saveApprovalData();
            alert('Feedback saved!');
        }
        
        // Update statistics
        function updateStats() {
            const stats = {
                total: scenarios.length,
                pending: 0,
                approved: 0,
                revision: 0,
                rejected: 0
            };
            
            scenarios.forEach(scenario => {
                const status = approvalData[scenario.id]?.status || 'pending';
                stats[status]++;
            });
            
            document.getElementById('stat-total').textContent = stats.total;
            document.getElementById('stat-pending').textContent = stats.pending;
            document.getElementById('stat-approved').textContent = stats.approved;
            document.getElementById('stat-revision').textContent = stats.revision;
            document.getElementById('stat-rejected').textContent = stats.rejected;
        }
        
        // Export approval data
        function exportApprovalData() {
            const exportData = {
                exportDate: new Date().toISOString(),
                approvals: approvalData,
                summary: {
                    total: scenarios.length,
                    approved: Object.values(approvalData).filter(a => a.status === 'approved').length,
                    needsRevision: Object.values(approvalData).filter(a => a.status === 'revision').length,
                    rejected: Object.values(approvalData).filter(a => a.status === 'rejected').length
                },
                learningNotes: []
            };
            
            // Compile learning notes from feedback
            Object.entries(approvalData).forEach(([scenarioId, data]) => {
                if (data.feedback) {
                    const scenario = scenarios.find(s => s.id === scenarioId);
                    exportData.learningNotes.push({
                        scenarioId,
                        title: scenario?.title,
                        status: data.status,
                        feedback: data.feedback,
                        timestamp: data.timestamp
                    });
                }
            });
            
            // Download as JSON
            const blob = new Blob([JSON.stringify(exportData, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `scenario-approvals-${new Date().toISOString().split('T')[0]}.json`;
            a.click();
        }
        
        // Filter functionality
        document.addEventListener('DOMContentLoaded', () => {
            // Set up filter buttons
            document.querySelectorAll('.filter-btn').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
                    e.target.classList.add('active');
                    currentFilter = e.target.dataset.filter;
                    displayScenarioList();
                });
            });
            
            // Load initial data
            loadApprovalData();
            loadEmbeddedScenarios();
        });
    </script>
</body>
</html>